{% extends 'base.html' %}

{% block title %}Finansowy bilans{% endblock %}
{% block body_class %}bg{% endblock %}

{% block body %}
<div class="container mb-5">
    {% include 'Partials/menu-header.html' with {'active': 'balance'} %}
    <main class="balance">
        <div class="row p-3 border-bottom">
            <div class="col-md-6">
                <h1>
                    <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-bar-chart-line" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                        <path fill-rule="evenodd" d="M4 11H2v3h2v-3zm5-4H7v7h2V7zm5-5h-2v12h2V2zm-2-1a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1h-2zM6 7a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v7a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V7zm-5 4a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1v-3z"></path>
                        <path fill-rule="evenodd" d="M0 14.5a.5.5 0 0 1 .5-.5h15a.5.5 0 0 1 0 1H.5a.5.5 0 0 1-.5-.5z"></path>
                    </svg>
                    Finansowy bilans
                </h1>
                <p class="text-secondary">Okres:&nbsp;<strong>
                    {% if period == 'unstandardized' %}
                    od:&nbsp;<span>{{ start_date }}</span>&nbsp;do:<span>{{ end_date }}</span>
                    {% else %}
                    {{ period }}
                    {% endif %}
                </strong>
                </p>
            </div>
            <div class="col-md-6 text-right pt-2">
                <div class="dropdown">
                    <a class="dropdown-toggle" href="/financial-balance/current-month" role="button" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        {{ period }}
                    </a>
                    <div class="dropdown-menu  dropdown-menu-right" aria-labelledby="dropdownMenuLink">
                        <a class="dropdown-item {% if period == 'current-month' %}active{% endif %}"
                           href="/financial-balance/current-month">Bieżący miesiąc</a>

                        <a class="dropdown-item {% if period == 'last-month' %}active{% endif %}"
                           href="/financial-balance/last-month">Poprzedni miesiąc</a>

                        <a class="dropdown-item {% if period == 'current-year' %}active{% endif %}"
                           href="/financial-balance/current-year">Bieżący rok</a>

                        <a class="dropdown-item {% if period == 'unstandardized' %}active{% endif %}"
                           data-toggle="modal" data-target="#unstandardizedPeriod" href="#">Niestandardowy</a>
                    </div>
                </div>
            </div>
        </div>
        <div class="row justify-content-center py-4">
            <div class="col-lg-5 col-md-6">
                <h2>Przychody</h2>

                <table class="table">
                    <thead class="thead-light">
                    <tr>
                        <th scope="col">#</th>
                        <th scope="col">Kategoria</th>
                        <th scope="col">Kwota (PLN)</th>
                    </tr>
                    </thead>
                    <tbody>
                    {% if incomes is not empty %}
                        {% for key, income in incomes %}
                        <tr>
                            <td>{{ key+1 }}</td>
                            <td>{{ income.category_name }}</td>
                            <td>{{ income.sum }}</td>
                        </tr>
                        {% endfor %}
                    {% else %}
                    <tr>
                        <td>-</td>
                        <td>-</td>
                        <td>-</td>
                    </tr>
                    <div class="alert alert-danger text-center">Brak przychodów w podanym okresie.</div>
                    {% endif %}
                    </tbody>
                </table>
            </div>
        </div>
        <div class="row justify-content-center py-4">
            <div class="col-lg-5 col-md-6">
                <h2>Wydatki</h2>
                <table class="table">
                    <thead class="thead-light">
                    <tr>
                        <th scope="col">#</th>
                        <th scope="col">Kategoria</th>
                        <th scope="col">Kwota (PLN)</th>
                    </tr>
                    </thead>
                    <tbody>
                    {% if expenses is not empty %}
                        {% for key, expense in expenses %}
                        <tr>
                            <td>{{ key+1 }}</td>
                            <td>{{ expense.category_name }}</td>
                            <td>{{ expense.sum }}</td>
                        </tr>
                        {% endfor %}
                    {% else %}
                    <tr>
                        <td>-</td>
                        <td>-</td>
                        <td>-</td>
                    </tr>
                    <div class="alert alert-danger text-center">Brak wydatków w podanym okresie.</div>
                    {% endif %}
                    </tbody>
                </table>

            </div>
        </div>
        <div class="row justify-content-center border-bottom">
            <div id="piechart"></div>
        </div>
        <div class="row justify-content-center py-4">
            <div class="col-md-6 text-center">
                <h2>Twój finasowy bilans:</h2>
                {% if summary > 0 %}
                <p class="text-success summary mb-0">{{ summary }}&nbsp;PLN</p>
                <p class="text-success">
                    Gratulacje! Świetnie zarządzasz finansami!
                </p>
                {% elseif summary == 0 %}
                <p class="text-secondary summary mb-0">{{ summary }}&nbsp;PLN</p>
                {% else %}
                <p class="text-danger summary mb-0">{{ summary }}&nbsp;PLN</p>
                <p class="text-danger">
                    Powiększ swoje przychody lub pomniejsz wydatki.
                </p>
                {% endif %}
            </div>
        </div>
    </main>
</div>
{% endblock %}

{% block footer %}
<script src="/bootstrap/bootstrap.bundle.min.js"></script>
<script src="https://www.gstatic.com/charts/loader.js"></script>
<script src="/js/app.js"></script>
<script>


</script>
{% endblock %}