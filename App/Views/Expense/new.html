{% extends 'base.html' %}

{% block title %}Dodawanie wydatku{% endblock %}
{% block body_class %}bg{% endblock %}

{% block body %}
<div class="container mb-5">
    {% include 'Partials/menu-header.html' with {'active': 'expense'} %}

    <main class="add-expense pb-5">
        <div class="row justify-content-center">
            <div class="col-lg-5 col-md-6">
                <h1 class="py-md-5 py-4 text-center">
                    <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-graph-up" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                        <path d="M0 0h1v16H0V0zm1 15h15v1H1v-1z"/>
                        <path fill-rule="evenodd" d="M14.39 4.312L10.041 9.75 7 6.707l-3.646 3.647-.708-.708L7 5.293 9.959 8.25l3.65-4.563.781.624z"/>
                        <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 1 .5-.5h4a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-1 0V4h-3.5a.5.5 0 0 1-.5-.5z"/>
                    </svg>
                    Dodaj wydatek
                </h1>

                {% if expense.errors is not empty %}
                <ul class="mb-5">
                    {% for error in expense.errors %}
                    <li>{{ error }}</li>
                    {% endfor %}
                </ul>
                {% endif %}

                <form method="post" action="/add-expense/create" id="formAddExpense">
                    <div class="form-group row">
                        <label for="amount" class="col-sm-2 col-form-label">Kwota</label>
                        <div class="col-sm-10">
                            <input type="number"
                                   class="form-control"
                                   id="amount"
                                   name="amount"
                                   placeholder="Wprowadź kwotę np. 12.45"
                                   required
                                   value="{{expense.amount}}">
                        </div>
                    </div>
                    <div class="form-group row">
                        <label for="date" class="col-sm-2 col-form-label">Data</label>
                        <div class="col-sm-10">
                            <input type="date"
                                   class="form-control"
                                   id="date"
                                   name="date"
                                   required
                                   {% if expense.date is not empty %}
                                    value="{{expense.date}}"
                                   {% endif %}
                            >
                        </div>
                    </div>
                    <div class="form-group row">
                        <label for="paymentMethod" class="col-sm-2 col-form-label">Sposób płatności</label>
                        <div class="col-sm-10">
                            <select class="form-control"
                                    id="paymentMethod"
                                    name="payment_method"
                                    aria-describedby="validationServer03"
                                    required>
                                {% for method in payment_methods %}
                                    <option value="{{ method.id }}">{{ method.name }}</option>
                                {% endfor %}
                            </select>
                        </div>
                        <input type="hidden" id="fr_paymentMethod" value="{{expense.payment_method}}">
                    </div>
                    <div class="form-group row">
                        <label for="category" class="col-sm-2 col-form-label">Kategoria</label>
                        <div class="col-sm-10">
                            <select class="form-control"
                                    id="category"
                                    name="category"
                                    aria-describedby="validationServer04">
                                    {% for category in expense_categories %}
                                    <option value="{{ category.id }}">{{ category.name }}</option>
                                    {% endfor %}
                            </select>
                        </div>
                        <input type="hidden" id="fr_category" value="{{expense.category}}">
                    </div>
                    <div class="form-group">
                        <label for="comment">Komentarz</label>
                        <textarea class="form-control" id="comment" name="comment" rows="4" placeholder="Dodaj komentarz (opcjonalnie)">{{expense.comment}}</textarea>
                    </div>
                    <div class="form-group row">
                        <div class="col-sm-12 text-right">
                            <a class="btn btn-outline-secondary" href="/">Anuluj</a>
                            <button type="submit" class="btn btn-primary">Dodaj</button>
                        </div>
                    </div>
            </form>

        </div>
    </div>
</main>
</div>
{% endblock %}

{% block footer %}
<script src="/js/app.js"></script>
<script>
    $(document).ready(function() {
        $('#formAddExpense').validate({
            rules: {
                amount: {
                    required: true,
                    validAmount: true
                },
                date: {
                    required: true,
                    validDate: true,
                },
                category: 'required',
                payment_method: 'required',
            }
        });
    });
</script>
{% endblock %}